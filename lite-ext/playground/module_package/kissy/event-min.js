/*
Copyright 2011, KISSY UI Library v1.1.7dev
MIT Licensed
build time: ${build.time}
*/
KISSY.add("event/base",function(h,g,o,l){function k(a,b,d,f,i){if(h.isString(b))b=g.query(b);if(h.isArray(b)){h.each(b,function(j){n[a](j,d,f,i)});return true}if((d=h.trim(d))&&d.indexOf(z)>0){h.each(d.split(z),function(j){n[a](b,j,f,i)});return true}return l}function c(a){return a&&a.nodeType!==3&&a.nodeType!==8?g.data(a,y):-1}function e(a,b){a&&a.nodeType!==3&&a.nodeType!==8&&g.data(a,y,b)}var m=document,q=m.addEventListener?function(a,b,d,f){a.addEventListener&&a.addEventListener(b,d,!!f)}:function(a,
b,d){a.attachEvent&&a.attachEvent("on"+b,d)},A=m.removeEventListener?function(a,b,d,f){a.removeEventListener&&a.removeEventListener(b,d,!!f)}:function(a,b,d){a.detachEvent&&a.detachEvent("on"+b,d)},y="ksEventTargetId",z=" ",B=h.now(),x={},n={EVENT_GUID:y,special:{},add:function(a,b,d,f){if(!k("add",a,b,d,f)){var i=c(a),j,r,s,u,t;if(!(i===-1||!b||!h.isFunction(d))){if(!i){e(a,i=B++);x[i]={target:a,events:{}}}r=x[i].events;if(!r[b]){j=((i=!a.isCustomEventTarget)||a._supportSpecialEvent)&&n.special[b]||
{};s=function(p,v){if(!p||!p.fixed)p=new o(a,p,b);if(h.isPlainObject(v)){var w=p.type;h.mix(p,v);p.type=w}j.setup&&j.setup(p);return(j.handle||n._handle)(a,p)};r[b]={handle:s,listeners:[]};u=j.fix||b;t=j.capture;j.init&&j.init.apply(null,h.makeArray(arguments));i&&j.fix!==false&&q(a,u,s,t)}r[b].listeners.push({fn:d,scope:f||a})}}},__getListeners:function(a,b){var d,f=[];if(d=(n.__getEvents(a)||{})[b])f=d.listeners;return f},__getEvents:function(a){var b=c(a),d;if(b!==-1)if(b&&(d=x[b]))if(d.target===
a)return d.events||{}},remove:function(a,b,d,f){if(!k("remove",a,b,d,f)){var i=n.__getEvents(a),j=c(a),r,s,u,t,p,v,w=(!a.isCustomEventTarget||a._supportSpecialEvent)&&n.special[b]||{};if(i!==l){f=f||a;if(r=i[b]){s=r.listeners;u=s.length;if(h.isFunction(d)&&u){p=t=0;for(v=[];t<u;++t)if(d!==s[t].fn||f!==s[t].scope)v[p++]=s[t];r.listeners=v;u=v.length}if(d===l||u===0){if(!a.isCustomEventTarget){w=n.special[b]||{};if(w.fix!==false)A(a,w.fix||b,r.handle)}delete i[b]}}w.destroy&&w.destroy.apply(null,h.makeArray(arguments));
if(b===l||h.isEmptyObject(i)){for(b in i)n.remove(a,b);delete x[j];g.removeData(a,y)}}}},_handle:function(a,b){var d=n.__getListeners(a,b.type);d=d.slice(0);for(var f,i=0,j=d.length;i<j;++i){f=d[i];f=f.fn.call(f.scope,b);if(f!==l){b.result=f;f===false&&b.halt()}if(b.isImmediatePropagationStopped)break}return f},_getCache:function(a){return x[a]},__getID:c,_simpleAdd:q,_simpleRemove:A};n.on=n.add;return n},{requires:["dom","event/object"]});
KISSY.add("event/focusin",function(h,g){document.addEventListener&&h.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(o){g.special[o.name]={fix:o.fix,capture:true,setup:function(l){l.type=o.name}}})},{requires:["event/base"]});
KISSY.add("event/mouseenter",function(h,g,o,l){l.ie||h.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(k){g.special[k.name]={fix:k.fix,setup:function(c){c.type=k.name},handle:function(c,e){if(o._isKSNode(c))c=c[0];var m=e.relatedTarget;try{for(;m&&m!==c;)m=m.parentNode;m!==c&&g._handle(c,e)}catch(q){}}}})},{requires:["event/base","dom","ua"]});
KISSY.add("event/object",function(h,g){function o(c,e,m){this.currentTarget=c;this.originalEvent=e||{};if(e){this.type=e.type;this._fix()}else{this.type=m;this.target=c}this.currentTarget=c;this.fixed=true}var l=document,k="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");
h.augment(o,{_fix:function(){var c=this.originalEvent,e=k.length,m,q=this.currentTarget;for(q=q.nodeType===9?q:q.ownerDocument||l;e;){m=k[--e];this[m]=c[m]}if(!this.target)this.target=this.srcElement||l;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===g&&this.clientX!==g){c=q.documentElement;e=q.body;this.pageX=this.clientX+(c&&c.scrollLeft||e&&e.scrollLeft||
0)-(c&&c.clientLeft||e&&e.clientLeft||0);this.pageY=this.clientY+(c&&c.scrollTop||e&&e.scrollTop||0)-(c&&c.clientTop||e&&e.clientTop||0)}if(this.which===g)this.which=this.charCode!==g?this.charCode:this.keyCode;if(this.metaKey===g)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==g)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var c=this.originalEvent;if(c.preventDefault)c.preventDefault();else c.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var c=
this.originalEvent;if(c.stopPropagation)c.stopPropagation();else c.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){var c=this.originalEvent;c.stopImmediatePropagation?c.stopImmediatePropagation():this.stopPropagation();this.isImmediatePropagationStopped=true},halt:function(c){c?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});return o});
KISSY.add("event/target",function(h,g,o,l){return{isCustomEventTarget:true,fire:function(k,c){var e=o.data(this,g.EVENT_GUID)||-1;if((e=((g._getCache(e)||{}).events||{})[k])&&h.isFunction(e.handle))return e.handle(l,c)},on:function(k,c,e){g.add(this,k,c,e);return this},detach:function(k,c,e){g.remove(this,k,c,e);return this}}},{requires:["event/base","dom"]});KISSY.add("event",function(h,g){return g},{requires:["event/base","event/target","event/object","event/focusin","event/mouseenter"]});
